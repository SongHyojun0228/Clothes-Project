<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('includes/head')%>
    <link rel="stylesheet" href="/styles/post-detail.css" />
    <script src="/scripts/cafe.js" defer></script>
    <title>Post Detail</title>
  </head>
  <body>
    <%- include('includes/header')%>
    <main>
        <div id="banner">
            <a href="/cafe"><h2>Cafe</h2></a>
        </div>

      <div id="container">
        <div id="left-container">
          <a href="/my-page" id="nickname"><%= user.nickname%></a>
          <p id="date"><%= user.date%> ê°€ì…</p>
          <a id="upload-post-btn" href="/upload-post">ì¹´í˜ ê¸€ì“°ê¸°</a>

          <p id="posts">ğŸ‘–ê²Œì‹œíŒğŸ‘–</p>

          <p id="fashion">fashion</p>
          <a href="/cafe-shoes" class="post-items">â†˜ï¸ ì˜¤ë­ì‹ </a>
          <a href="/cafe-look" class="post-items">â†˜ï¸ ì˜¤ëŠ˜ì˜ë£©</a>
          <a href="/cafe-select" class="post-items">â†˜ï¸ ê³¨ë¼ì¤˜</a>
          <a href="/cafe-drop" class="post-items">â†˜ï¸ ë°œë§¤ì •ë³´</a>
          <a href="/cafe-sale" class="post-items">â†˜ï¸ ì„¸ì¼ ì •ë³´</a>

          <p id="lifestyle">lifestyle</p>
          <a href="/cafe-free" class="post-items">â†˜ï¸ ììœ </a>
          <a href="/cafe-eat" class="post-items">â†˜ï¸ ë°¥ë°¥</a>
          <a href="/cafe-humor" class="post-items">â†˜ï¸ ìœ ë¨¸</a>
          <a href="/cafe-life" class="post-items">â†˜ï¸ ì¼ìƒ</a>
          <a href="/cafe-exercise" class="post-items">â†˜ï¸ ìš´ë™</a>
        </div>

        <div id="right-container">
          <div id="post-info">
            <a href="free-cafe" id="post-kind"><%= post.post_kind%> > </a>
            <p id="title"><%= post.title %></p>
            <div id="post-profile">
              <% if (profile) { %>
                <a href="/user/<%= post.author %>">
                  <img src="<%= profile %>" alt="ì‘ì„±ì í”„ë¡œí•„" class="author-profile-img" />
                </a>
              <% } else { %>
                <a href="/user/<%= post.author %>">
                  <img src="/images/profile/default_profile.png" alt="ê¸°ë³¸ í”„ë¡œí•„" class="author-profile-img" />
                </a>
              <% } %>
              <a href="/user/<%= post.author %>" id="user-nickname"><%= post.author %></a>
            </div>
            
            <div id="detail-container">
              <p id="post-date"><%= post.date %></p>
              <% if(post.author === user.nickname ) { %>
                <div class="authority-container">
                  <a href="/edit-post" class="authority">ìˆ˜ì •</a>
                  <button id="delete-btn" class="authority">ì‚­ì œ</button>
                </div>
              <% } %>
            </div>
          </div>

          <div id="content-container">
            <p id="content"><%= post.content%></p>
            <div id="img-container">
              <% if (post.images && post.images.length > 0) { %> 
                <% post.images.forEach(function(imagePath) { %>
                    <img
                        src="<%= imagePath %>"
                        alt="ê²Œì‹œë¬¼ ì´ë¯¸ì§€"
                        class="post-image"
                    />
                <% }) %> 
              <% } %>
            </div>
            <a id="see-more" href=""
              ><span><%=post.author%></span>ë‹˜ì˜ ê²Œì‹œê¸€ ë”ë³´ê¸° ></a
            >

            <div id="heart-container" data-post-id="<%= post._id %>" data-liked="<%= post.likedUsers && post.likedUsers.includes(user.nickname) %>">
              <button id="heart-button">
                <img src="<%= post.likedUsers && post.likedUsers.includes(user.nickname) ? '/images/heart/heart_red.png' : '/images/heart/heart_empty.png' %>"
                  id="heart"
                  alt="heart-img">
                  <!-- <span id="heart-text">ì¢‹ì•„ìš”</span> -->
              </button>
              <span id="like-count"><%= post.likes || 0 %></span>
            </div>
          </div>

          <div id="comment-container">
            <ul id="comment-list">
                <% for(const comment of comments) { %>
                    <li class="comment-item">
                      <div class="comment-profile">
                        <a href="/user/<%= comment.author %>">
                          <img src="<%= comment.profileImg %>" alt="ì‘ì„±ì í”„ë¡œí•„" class="comment-author-img" />
                        </a>
                        <a href="/user/<%= comment.author %>">
                          <p class="user-info"><%= comment.author %></p>
                        </a>
                      </div>
                        <p class="comment"><%= comment.comment %></p>
                        <p class="date"><%= comment.date %></p>
                      </li>
                <% } %>
              </ul>

              <form action="/cafe/<%= post._id%>/comment" method="POST" id="form-comment" data-post-id="<%= post._id %>" >
                <div id="comment-input-container">
                    <p for="comment"><%= user.nickname %></p>
                    <input type="text" id="comment" name="comment" placeholder="ëŒ“ê¸€ì„ ë‚¨ê²¨ë³´ì„¸ìš”."></input>
                    <button>ë“±ë¡</button>
                </div>
            </form>            
          </div>
        </div>
      </div>
    </main>
    <%- include('includes/footer')%>
  </body>
</html>
